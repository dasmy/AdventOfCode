input = '''><<>><<<>><>><<<<>><<>>>><<<<>>><>>><>><><><<<<>><<<>><<<>>>><>>>><<>>>><<>><<<><<<<>>><<<<>>>><<<<>><>>><<<<>><>>><<<>><<>>><<><<<<>><<<>><><>><>>>><<>><<<<><<><<<<><<<><<<>><<<<>><<<<>>><<<>>><<<<>>>><<<<>><<><<<<>>><><<<>>><<<>><<<>>>><<><<>>>><<<<><<>>><<<>><<<<>>><><<><<>><<>>>><>><<<>>>><<>>><>><<<>>><<<<>><<<<>>><<<<>>>><<>>>><>>><<<<>><<<<>>>><<<>><>>>><<>><<>><>><<<<>>><<<>>>><<<>>>><><>>>><<<><<<<>><<<<><<<>>>><<>>>><<<<>><<<<><<><<>>>><<<<>>><<<>>>><<<>>><>>>><<<>><<<<><>>><<<<>><<<<>>><><>>><<>><<<>>><<>>>><>>><<>><<<>>>><<<>><<<>>><><<<<><<<><<<<><<>><<<><<<><<<>><<>>><<>><<<<>>>><>><<<>>>><><<><<<<><<><<<><<>><<<>>>><<<>>>><<<<><>><<<<><<><>><<<<><<>><<<><><<><<>><><<<<><>><<>><<<>><<>>><<>>><><>><>>>><>>><<<<><<<<>><<<>>><<>><<<<>><<><>><<<>><><<<<><>>><<<<>>><>><>>><<><<<<>><<<<>>>><>><<>>>><>>>><<<>>><<<>>>><<<<>><<><<>>><<>><<<<>><>>><<>>><<>>>><<<<>><<<><<<>>><<<<><<<<>><<>>><<<<>>><<<<>>>><<><><<>>>><<<<>>><><><<>><<>>><>>>><>><<<<>><><>>><>><<<>><<>><<<<>><<>>>><><<<<>><<<>>><<><>><>>><<<>><<<<>>><<>>><>>><<<><<<<>><<>>><<>>><<>>><<<<>>>><<<>>><>>><<<>><>>>><<<>>>><<<<><>><<<<>>><<<>><<<<>><<>><<<>>>><<<>><<<<>><<<<><>>>><<<<>><<<<><<<>>><<<<><<<>>><>>><<<>><<>>>><<<><>><>>><<<>><><<<>><<><<<>>><<<<><<<>><<<>>>><>>>><>><<<<>>><<<<>>><>>><<><<<>><<>>><<<>>><<<<>>>><>><<<<>>>><<<>><<<>>>><<>><<<<>>><><<<><<<>>>><>>>><<<><>>><<<<><><<>><<<>>>><<<>>><>>><>>>><<<<>>>><><<<><<>>>><<>>><<<<>>><>>>><<<<>><<<<>>>><<><<<<>><<>><<<><<<<>>>><<<<>>><<<>><<>>>><><<<><<>>><<<<><<<<><>><>>>><<>><<<>>><>><<<>>>><<<>>><<><>><<<>><<<<>>><<<<><><<>>><<<<>>>><<>>>><<>>><<><<>><<>><<>><<<><><<>>>><<<>>>><>>>><<>><<>><<<<>><>>><<<><<>>><>>>><<<>>>><><<<<><<<>>>><<>><<<<>>><<<<><>>><<<><<>>>><<<<>>>><><<<>>><>><<><<>>>><<<>>><>><<<<><<<<>><<>>>><<<>>><><><<<<>>><<<>><<<>>><<>><<<<>>><<<<>>>><>>><>>><<<<>><<>><<<>>><<<<><<><<<<>><>>><<<<>><<<<>><<>><>><<<<>><<<<><>>>><<<><<<>>><><<>><<>><<>>>><<<>>>><<<<><<<<><><<<>>>><<<<><<<<><<><<<>><<<<>>><<<><<>><<<>>><<>>>><<<>><<<<><<<><<<<>>><<<>><<<<>>><<<<>><>>>><>>><<>>><<>><<>><<>><<>>><<<<><<<<>><<<<><<<<>>>><<<>>><>>>><><<>>>><>>><<<>><>>>><<>>><<<<>><<>><<<<>><<>>><<<<><><<>><<>>><<<<>>><<<><<>>><<<>>>><<>><>><<>>>><<<<>>>><><<<<>>>><>>><<>>>><<<<><<><<<<><<<<>><>><<<<><<<>>><<<>><>>><<<<>><<><<<<>>><>>>><<<>>><<<>>><<>>>><<<><>><<<>><<<><>>>><<>><<<<><<<<>>><<<>>>><><><<<>>><><>><<<<>><<><><<>>><>>><<<>>><<>>>><<>><<<>><>>><<>>><<<>><><<<><>><<><<<<><>>>><<<<>>>><>>><<>><<>>><<<<><<>>><<<<>>><<>>><><>>>><>>><>>>><<>><<>>>><>>>><>><<>><<<><<<>>>><<<<><<<<><>><<>>><<<<><<<>><<<><>>><><><<>><<>><>><<>>>><<<<><<><<>>><>><<>>>><<<<>>><<<>><<<>>><<>><<>>>><<<>>>><>>><>><>><<>>><<<<>>><<<<>>><<<><<<<>><<><<<>>><<<<>><<>>>><<<<>>>><<<>>>><<<<>>>><>><<><<>>>><<<<>>><<<<>>>><>>>><<<<><<<><<<<>><>>><>><><<<<>><<<<><<>>>><>>>><<<><<><<>>><<<>>>><<<>>><<<<>>><<>>><>>>><<<<>><<>>><><<<<><<><>>><<<<>>>><>><><<<>>>><>>>><<<<>>><<<>>>><<><>>><>>>><<<><>>>><<<<><<<<>>><>>><<<<>>><<<>>><<>>>><><<>><<<<>>>><<<><>>><>>>><<>>>><<>><<>>><<><<<>>>><<<>>>><<>>>><>>><<<<>>>><<<<>>>><<<<>>><<><<<<><>>>><>><<<><<>><<>><<>>>><<<<>>>><<<><<<>><<<>>><<<>>>><<><<><<<>><<<<>>><<<><<>><<><<>><<>>>><<>>><<<>><<<<><>><<<>>><>>><>><<><><>>><<><>><<<><>>>><<<>>><<<<>>><<<<>>><<><<>>>><>>><<<>>>><<<>><><<<<>><><<>>>><<<<>>><<<><<<<><<<><<>><<<><<<<>>>><><<<>>>><<<<>>>><<<<>>><<>>><<>><<<>>><>>>><><<>><<<<>>>><<>>>><<<>>><<>>><<<>>>><<<>>><<<>>><>>>><<>>><>>>><<<>><<>><<><<<>>><<<><<<<><<>>><<<>>>><<<<>><<>>><<<<>>>><>>><<>><<<<>><<><><<>>><<<<>>><<>><<<>><<>>>><<>><><>>><<<<>>>><>>><<>><>>>><<<<>>>><<<<>>>><><>><<<>>><<<><<><<<><<<<>>>><<><<<>>><>><>>><<<>>>><<<>>><<<>>>><<>>>><>><<<>>>><<><<<>><<<<>>><<><<<>><<<>>>><<<<>>><><<>>>><><>><<<>>><<>><>>>><<<<>><<<>>>><<<>>>><<>><<<<>>><<<>>><<<<>><>>><<<>>><<>><<><<>>><<<><<<<>><<<><<><<<>>>><<<>><>><><<<<>>><<>>><<<>>><<<<>>>><>>><<<>><<<<>><<<<>>>><<<>>>><<>>><<>><<<<>><<<>><<<<>>><<<<>>>><>><<<>>>><>><<<<>><<>><>>>><<<>>><<<<>>>><<>>>><>><>>><><>>><<><<<<>>><<<>>>><<<<>><<>>>><<<>>>><<<>>>><<<<>>><<><<<>>><<<>><<<<>>>><<<>>>><<<<><<<<>>><<<<>><<<>><<><<>>><<<<>>><><<<>><>>>><<<>><<<>><<<>>><>>>><<<<>>><<<>><<>>><<<>>>><<>><<><>>><<<>>>><<<><<><<>><<<>>>><>>>><<<>>><<<<><<<>><<<<>>><<<<>>><<><<>>><<<><<>>>><<<>><<<<>>><<<>>><<><<>>>><>>>><<<>>>><><<<>>><>>>><<>>><>>><<>><<><>>><<>>><>><<<><<<>>>><><<<><<<>>><<>>>><<<><<<<><<<<>>><<<<>>>><>><<<<><<<>>><>>><<><<<<>>><<>><<<<><><<>>><><<><>><<><<<<><<<>>><>>><<<<>><<>><<<><>>>><<<<>>>><<<<>>><><<><<<>>>><<>><<>><>>>><<>>><>>>><<<<>><>>>><>>>><<<<><<<<>><<>>>><<<><<><>>>><<<>>><<<>>><<<><>>>><>>><>>>><<>><<<<>>><<>>>><<>>><<>>><<<><<<><>><<<><>>><<>>>><<>>>><<><<>>><>>>><<<><<<<>>><>><<<<>>><<><<>>>><<<<><<<>>>><<>><<<>>>><>>><<><><<<><<<<>>><<<<>><<<<>><<<<>>><<<>>><<<>>><>><<<><<<><<<>><><<<>>>><<><<<><<<<>>>><>>>><<<><>>>><<<<>><>>>><<>><<>><<<><<<>>>><<<<>>><<<<>>>><>>><<<<>>>><>>><<<<>>>><<<<>>>><>>>><<<<><<<<><<<<>><>>><<<<><>>><<<<>>>><<<<>><<>>><<<<>><<<<><<<<>>>><<<<><<<<>>>><<<<>>>><<<<>>><<><<>>><<<<>>><<<>><<<>>>><<<>><>><<>>>><<<>><<<><<<>>>><<<<>>><<<><<<<>>><<<<>><<>><<>>><<>>>><>>><<><<<>>><<<><<>>><<<>><>><<<><<>>><<<><>>><<<><<><<><<>>><<<<><<<>>><>>><<<>>><<>><<>>><<>><>><<<><<<<><>>>><<<><<><<>>><<<>>>><<<<>>>><<<<><<>>>><<<>>><<<<>>><<<>><<<<>>>><>><><>>>><<>><<<<><<<>>><><>>><><>>><<>><<<<><<>><<<>>><<<><>>>><<<>><<>>>><<<><<>>>><<><<<><<<<>>>><>><<>><<<<>>><<>><<>>>><<<><<<>>><<<>>><<<<>><<<><>><<<<>>>><<<<>><<<<>>>><<<<>>><><<<<>>>><<>><>>><<<<>>><<<<>>>><<>>>><>>>><<>><<<<>><<<<>><<>>>><<<<>>><<>>><<<<>>>><<<<>>>><>><<>>>><<>><><<<<>><<><<<>>><>>><<<<><>>><><<<>>><<><<<>><>><<<<>><><<<<>><<<>><<<<><<<>><>>>><<<>>>><<<>>><<<<>><<<>>><<<><<<><<<>><<<<><<>>>><<<><<>><>>><>>><>><<<>><<<>><<<<>>><<<<>>><<<<><<>><>><<<>>>><<<>>>><>>><>><<<<>>>><<<>>><<<>>>><>><<<<>>><><<<<>>><<><>>><<<<>><>>><<<<>>>><>>><<>>>><<>><>>><<>>><<>><<<><<<<>><>>><<>><<<><><>>>><<>>><<<<>>>><<<><<<<>><>><<<>>><<<>><<<>>>><<<><><<<<>>><<<><<<><<><<>><<>>>><<<<><>>><<<>>>><<<>>>><<<>>>><<<>><>><>>><<<<><<<<>><<<<>>>><>>><<>>>><<<<><<>><>><<><>>>><>>><<<>><<<>><>><<<>><<<><<<<>>>><<<<><<<>><<>><<><<<<><<>>><<<>>>><<<><<<<>><<<><>><<<>>>><<><<>>><<<<>><<<<>>>><>>>><<>>>><<<>>><<><<<>>>><>><<<>>><>><<<>>>><<<<>>>><<<>><>>>><<<<>>><<<<>>><>>><<<>>>><<><<<<><<>>>><>>>><<<>><>><>>><<><><>>><<>>><>>>><<<<>>>><<<<>>><>><<<>><<>><<>><<><<<>>><<<><<<<>>><<<>>>><<>><<<>>>><<>>><<<<>><<>>><<<<><<><><<<<><<<><<<>>>><><<<><>>>><<>>>><<<<>><<<><<>>><<>><<<<>><<<<>><<><>><>>><<<>>>><><<<><<<<>>>><<<<><>>><<><<>>>><>><>>><<<<>>>><>>>><<<<><<>>><>>>><<<<>>>><<<<>>><<<><<<<>>><<<<>>><>>>><>>>><<><<<<><<<>>><><<>>><>>><<<>>><<<>><<>>><<<><<><<<<>>><>>>><<>>>><<<>><<>>>><>>><<><<>><<<>>>><<<><<<<>>>><<<><<>><>>><<>><<<<>><><>>>><<<<>><<>>><<>>>><<><<<<><<>><<><<<<><<<<><<>>>><>><<>>>><>>><<<>>>><<<>><<<>>><<<>><<<<>>><><<><><<<>><<>>><<<>>><>><<><>>><>><<<<>>>><>><<<<>>>><>><<<>>><<>><<>><<>>>><<><<<>>><<<<><>><<<>>>><<>>>><<<<>>><<<<>>>><<<<><<<>>>><<<><<<<><<<<>>>><>><<<>>><<<<><<><<>><<<<>>>><<<<>>>><<<<>>><>>><<>>><>>>><<<<>>>><<>><<><>>>><<>>>><<>><<<<>>>><<<<>>>><<<>>>><<>>><<>>><<<>>>><<>>>><<<><>><<<><<><<>><<<<>>><>>>><<<<>>><><<<>>><<>>>><>>><<>>>><<>>><<>>>><>>><<<<>>><<<><>>><<<<>>>><<<>>><><<<<>><<<<>>><<>>>><<<><><><<<>>><<<>>><>><<<>><<<>>><<<>>>><>>>><<<<>>><>>><<<><>><<>><<<<>>>><<<>><>>><<>>>><<<>>><><<<<>>><<<>>>><>><>>><<><<<>>>><<<<>>><<<>>><<>>><<<>>>><<<<>>><>>>><<<<><<<>>><<<>>>><>><<<>>><<><<<<>><<>><<><<<<><<<><<>>>><<>><<><<<>><<<<>>>><<><<<>>><<<>>><<<<>>><<<<><<<<>><<<><<>>>><<<<>><<<>>><><<>>>><<>>><<<<><<<>><<>><<>><<>><<>>><<<>>>><<>>>><<<>><>>>><<<>><<>>><<<<><<<>>><<<<>><<<>>>><>>>><<<>><<<<><<<>>><>><<<>>>><>><>>><><<<<><<<<>>><<<<>>><<<>>>><<>>>><<<<>>>><<<><<<>>><<>>>><<>>>><<<<>><<>>>><<>>>><<><<<<>>>><>><><<<<>>><<<<>>><<>><<><>>>><<>>>><<<>>><><<>><<>>>><<>>>><<<<>>>><<><<>><<<>><<<><>><>>>><>>><<<>><<<<><<<<><<><<>>>><<<<><>>>><<<<>>><<<<>>>><<<<>>><<<>>><<<<><><<<<>><<<<>>>><<>><>>><<<<><<<>>>><<<>>><>>><<>>>><<<<>>><<>>>><>>>><<<><<<>>>><<>>>><<<<>>><>>><<<><<><><<>><<>>><<><<<<><<>>>><<<><<<><<<>><<<<>><<<>>>><>>><<><<<<>>><>>>><>><<<<>>><<<>>>><>><>><<<><<<<>>><>>>><>>><>><<<<>>><<<<>>>><<>>>><<>>><>>><<><<<>>><<<>><<>>><><>>>><<><>><>><<<><<>>><><<<><<<><>>>><<<>><<>>>><>>><>>>><<<>>>><>>>><<<><<<<>>><<<>><<<>><<<<>><<<>>>><>>>><<<><<<>>><<<<>>>><<>>>><>>><<><<><<<>>>><<><>><>><<<<>><<<><<<>>>><>><>><<<<><<<<><<><<<<>>><<<>><<<><<>>><<>>><<>><<<><<>>>><<><<<<>>>><<<>>>><<>><>>>><<>>>><<<>>>><>>><<<<>>><<<<>>><<<>>><<<>>>><<>>><<>>>><<<><<>>>><<<>>><<<>><>>><<<<>>><<>><<<<>><<<>><<<>>>><<<<>><>>>><>><<<<>>><<>>><><<<<>><<<><<<<><>>><>>>><>><<<>>>><<><<<<>>><>>>><<>>><<<<>><<<><<<>><<<>>><<>>><<<<>>>><<>><>><<<>>><><<>>><>>><<<>><<<><>>><>><<<<><<<>><<<><><<<>>>><<<<>><<>>>><>>>><<>><<<<>><<<><<<><<>>><<<><>><><<<>>><<<<><<<<>>>><<<<><<<>>>><<<><<>>>><<>>>><<<<>><<<><<<<>>><<<<>>><<<>>><>><<>>>><<<><<>><<<<>>>><<<>><>>><<<>>>><<<><<<<><<><<<><><<><<>><<>><<<<><<<<>><<<<>>><><<<<><>><<>><>>><>>>><<<>>><<<>>><<<>>><<<><<<>>>><>>>><<<>><<<>><><<<>>>><<<<>>><<>><<<<>>><<>>><<><>>><<<<><<<>><>>><<>>>><>>><<<<><<<>>><<><<>><<>><<<>><<<<>><<>><>><<>>><><>>><<<>>>><<<>>>><<<<>><<<>>><<>>><<<>>>><<<>>><><<<>><><<>>><<<>>><<<><>>>><>>>><<<>><<<<><><<>><<>>>><><<<<>>>><<<<>>>><<<<>><<<><>>><<<<>>><<<<>>><>><<><>>>><>><<>>>><>>>><<<<>><<<>><><<<>>><><><<<>>>><<<><<>><<>>>><<<<>><<<>>><<>>>><<<<>><<<<>><<>>>><<>>><>><<>><<<<>><<>>>><<><><<<>>><<>><<>>><<<>>><<<>>><<<><<<<>>>><<<<>><<<>><>>><<<<>><><<<<>>><<>>>><<<>>>><<>>>><<<>>>><><<<>>><<<<>>><<>><<<<>>>><<<<>>><<<<>>><<<<>>><>>>><<<>><<<>>>><<<>>>><>><<<<>>>><>>>><>><<<>>>><<<>>>><>>><<><<<<>>>><><<<<>><<<>>>><<<><<<>>><<><<<><<>><<<<>><<<>>><>><<<>>><>>>><>>><<<<>>>><><>><<<>>><<<><<<<>>><><<<><<>><>>>><>>><<<>>>><<<<>>>><<<<>>><<>>><<>>><<<>><<<>>>><<<>>>><><<>><<<><>><<<>>><<<>><<<<><<>>><>>><<>>><<>><>>>><<>><><>>>><<><>><>>><<>>><<<<>><<<>><<>><<><<<<>>><>>><>>>><>>><>>>><<<<>>>><<>>><<<<>>>><<<>><<>><<<>><<<<>>><<>><<>>><<<<>>><>>>><<>>>><<>><<>>><<<>>>><><<<<>>>><<<>>><<><<<<>>>><<><<<<>>>><<>><<<<><>><<>>><<<>>><<>><<<<><<>><<><<<<><'''


import numpy as np
from itertools import cycle


rocks = [
    np.array([[1, 1, 1, 1]], dtype=bool),
    np.array([[0, 1, 0], [1, 1, 1], [0, 1, 0]], dtype=bool),
    np.array([[1, 1, 1], [0, 0, 1], [0, 0, 1]], dtype=bool),
    np.array([[1], [1], [1], [1]], dtype=bool),
    np.array([[1, 1], [1, 1]], dtype=bool),
]

dir = {'>': 1, '<': -1}

max_height = 2022 * sum(p.shape[0] for p in rocks) // len(rocks) + 2
cave = np.zeros((max_height + 1, 9), dtype=bool)
cave[0] = True
cave[:, 0] = True
cave[:, 8] = True


prev_state = None
top_row = 0
jet = 0
total_shift = 0
irock = 0
for rock in cycle(rocks):
    irock += 1
    while np.any(cave[top_row, 1:8]):
        top_row += 1

    if irock == 1000000000001:
        break

    start_row = top_row + 3
    start_col = 3

    pattern = np.zeros_like(cave, dtype=bool)
    pattern[start_row:start_row+rock.shape[0], start_col:start_col+rock.shape[1]] = rock

    while True:
        if jet % len(input) == 0:
            new_floor = np.asarray([np.nonzero(cave[:, icol])[0][-1] for icol in range(1, 8)])
            delta = max(np.min(new_floor), 0)
            total_shift += delta
            cave = np.roll(cave, -delta, 0)
            cave[np.max(new_floor) - delta + 1:, 1:8] = False
            pattern = np.roll(pattern, -delta, 0)
            top_row -= delta

            progress = (irock, total_shift)
            state = (tuple(new_floor - delta), irock % len(rocks), delta)
            print(progress, state)
            if prev_state is not None and prev_state[1] == state:
                # we found a cycle
                pass
                passed_rocks = progress[0] - prev_state[0][0]
                rocks_todo = 1000000000000 - progress[0]
                fast_forward = rocks_todo // passed_rocks
                print(f'Fast forward by {fast_forward} cycles')
                irock += fast_forward * passed_rocks
                total_shift += fast_forward * delta
            else:
                prev_state = progress, state

        moved = np.roll(pattern, dir[input[jet % len(input)]], axis=1)
        jet += 1
        if not np.any(np.logical_and(cave, moved)):
            pattern = moved

        moved = np.roll(pattern, -1, axis=0)
        if not np.any(np.logical_and(cave, moved)):
            pattern = moved
        else:
            np.logical_or(cave, pattern, out=cave)
            break


print(top_row - 1 + total_shift)
